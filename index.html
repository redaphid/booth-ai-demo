<!DOCTYPE html>
<html>

<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="styles/main.css" type="text/css" rel="stylesheet">
  <script type="module">
    import { marked } from 'https://cdn.jsdelivr.net/npm/marked/lib/marked.esm.js'
    import { h, render } from 'https://esm.sh/preact'
    import htm from 'https://esm.sh/htm'
    const Products = ({ products }) => {
      return html`
        <div class="products">
          ${products.map(product => html`
            <${Product} product=${product}/>
          `)}
        </div>
      `
    }
    const Product = ({ product }) => {
      console.log({product})
      const productImage = product.image_urls[0]
      return html`
        <div class="product">
          <h2>${product.product_name}</h2>
          <img src=${productImage} alt=${product.product_name}/>
          <div class="batches">
            ${product.generation_batches.map(batch => html`
              <${Batch} productImage=${productImage} batch=${batch}/>
            `)}
        </div>
      `
    }
    const Batch = ({ batch }) => {
      console.log({batch})
      return html`
        <div class="batch">
          <h3>${batch.batch_name}</h3>
          <p>${batch.description}</p>
          <p>${batch.price}</p>
          <p>${batch.quantity}</p>
        </div>
      `
    }
    const App = ({ title,products }) => {
      return html`
        <div class="app">
          <h1>${title}</h1>
          <${Products} products=${products}/>
        </div>
      `
    }
    const res = await fetch('data/inventory.json').then(res => res.json())

    const html = htm.bind(h)
    render(html`<${App} title="HI" products=${res}/>`, document.body)
    </script>

</head>

<body></body>

</html>
